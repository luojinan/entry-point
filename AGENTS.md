# Repository Guidelines

## Project Structure & Module Organization
- `src/routes/` contains TanStack Router file-based routes (for example `__root.tsx`, `index.tsx`).
- `src/components/ui/` holds reusable shadcn/base-ui primitives; keep shared UI here.
- `src/components/` is for feature/demo components composed from UI primitives.
- `src/lib/` stores utility helpers (for example `src/lib/utils.ts`).
- `public/` contains static assets.
- `src/routeTree.gen.ts` is generated by routing tooling; do not edit it manually.
- Main config files: `vite.config.ts`, `wrangler.jsonc`, `biome.json`, `tsconfig.json`.

## Browser Automation

Use `agent-browser` for web automation. Run `agent-browser --help` for all commands.

MUST USE CDP 9222

Core workflow:
1. `agent-browser --cdp 9222 open <url>` - Navigate to page
2. `agent-browser --cdp 9222 snapshot -i` - Get interactive elements with refs (@e1, @e2)
3. `agent-browser --cdp 9222 click @e1` / `fill @e2 "text"` - Interact using refs
4. Re-snapshot after page changes

## Build, Test, and Development Commands
Use `pnpm` (this repo is pinned by `pnpm-lock.yaml`).

- `pnpm dev`: start local development server on port `3000`.
- `pnpm build`: create the production build with Vite.
- `pnpm preview`: serve the production build locally.
- `pnpm lint`: run Biome linter checks.
- `pnpm format`: apply Biome formatting.
- `pnpm check`: run Biome checks with auto-fixes.
- `pnpm deploy`: build and deploy to Cloudflare Workers via Wrangler.

## Coding Style & Naming Conventions
- Stack: TypeScript + React function components.
- Formatting and linting are enforced by Biome (`biome.json`); indentation uses spaces.
- Prefer direct React hook imports (for example `useState`) instead of namespace calls like `React.useState`.
- Run `pnpm format` before opening a PR.
- Prefer clear, small modules and colocate related code under `src/`.
- UI component filenames in `src/components/ui/` use lowercase kebab-case (for example `alert-dialog.tsx`).
- Route files should follow TanStack Start conventions (`__root.tsx`, `index.tsx`).

## Route Layout Contract
- App shell in `src/routes/__root.tsx` uses fixed viewport height (`h-svh`) with `overflow-hidden`.
- Every new route page must own scrolling at route root:
  - `className="flex min-h-0 flex-1 overflow-y-auto"`
- Keep width and spacing on an inner wrapper (`mx-auto max-w-* p-*`) inside that scroll container.
- For pages with sticky bottom UI (for example chat composer), keep window/body non-scrollable and implement sticky behavior inside the route with `min-h-0 + overflow-hidden + sticky bottom-0`.

## Testing Guidelines
- No dedicated automated test runner is configured yet.
- Minimum validation for contributions: `pnpm lint` and `pnpm build`, plus manual smoke testing via `pnpm dev`.
- If adding tests, use `*.test.ts` or `*.test.tsx` near the related source and add the test script to `package.json`.

## Commit & Pull Request Guidelines
- Follow Conventional Commit style used in history: `feat: ...`, `fix: ...`, `chore: ...`.
- Keep commits atomic and focused on one logical change.
- PRs should include:
  - concise summary and reason for change
  - linked issue/task (if applicable)
  - screenshots for UI updates
  - verification steps run locally (for example `pnpm lint`, `pnpm build`)

## Security & Configuration Tips
- Store secrets in `.env`; do not commit credentials.
- Review Cloudflare deployment settings in `wrangler.jsonc` before releasing.
